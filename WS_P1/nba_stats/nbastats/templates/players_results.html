{% extends "layout.html" %}

{% block content %}

<div class="container text-center my-5" style="width: 600px; margin: auto;">
    <h1 class="display-4 font-weight-bold mb-4" >Search Players</h1>
    <div class="mb-4">
        <p class="lead" style="color: #777;">Search for a player's name below and get their stats per season</p>
    </div>
    <form class="form-inline justify-content-center" role="search" method="get">
        <div class="form-group mx-sm-3 mb-2">
            <label for="search_text" class="sr-only">Search by player name</label>
            <input class="form-control" name="search_text" type="search" placeholder="Insert player name here" aria-label="Search by player name" style="width: 100%; padding: 12px 20px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box;">
        </div>
        <div class="form-group mx-sm-3 mb-2">
            <label for="search_season" class="sr-only">Search by season</label>
            <input class="form-control" id="search_season" name="search_season" type="number" min="1947" step="1" max="2023" placeholder="Insert season here" aria-label="Search by season" disabled style="width: 100%; padding: 12px 20px; margin-top: 16px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box;">
            <div class="form-check form-check-inline" style="margin-top: 16px;">
                <input type="checkbox" id="checkbox" onclick="myFunction()" style="margin-right: 5px;">
                <label class="form-check-label" for="checkbox" style="color: #777;">Search by season</label>
            </div>
        </div>
        <button class="btn btn-lg btn-success mb-2" type="submit" style="width: 100%; background-color: #4CAF50; border: none; color: white; padding: 15px 32px; text-align: center; text-decoration: none; display: inline-block; font-size: 16px; margin: 4px 2px; cursor: pointer; border-radius: 4px;">Search</button>
    </form>

    <p style="margin-top: 30px;"> Search for: {{ search_text }} - Season: {{ search_season }}</p>
</div>

<table style="border-collapse: collapse; width: 100%; font-family: Arial, sans-serif; font-size: 14px; margin-bottom: 3rem;">
    <thead style="background-color: #f2f2f2;">
        <tr>
            <th style="text-align: left; padding: 12px; border: 1px solid #ddd;">Name</th>
            <th style="text-align: left; padding: 12px; border: 1px solid #ddd;">Season</th>
            <th style="text-align: left; padding: 12px; border: 1px solid #ddd;">Team</th>
            <th style="text-align: left; padding: 12px; border: 1px solid #ddd;">Position</th>
            <th style="text-align: left; padding: 12px; border: 1px solid #ddd;">Points</th>
            <th style="text-align: left; padding: 12px; border: 1px solid #ddd;">Assists</th>
        </tr>
    </thead>
    <tbody>
        {% for result in results %}
        <tr style="background-color: #fff; cursor: pointer;" onmouseover="this.style.backgroundColor='#f5f5f5';" onmouseout="this.style.backgroundColor='#fff';" onclick="showInfo('{{ result.name }}', '{{ result.season }}', '{{ result.team_code }}', '{{ result.position }}', '{{ result.points }}', '{{ result.assists }}', '{{ result.blocks }}', '{{ result.steals }}', '{{ result.games_played }}', '{{ result.minutes_played }}', '{{ result.three_points }}', '{{ result.two_points }}')">
            <td style="padding: 12px; border: 1px solid #ddd;">{{ result.name }}</td>
            <td style="padding: 12px; border: 1px solid #ddd;">{{ result.season }}</td>
            <td style="padding: 12px; border: 1px solid #ddd;">{{ result.team_code }}</td>
            <td style="padding: 12px; border: 1px solid #ddd;">{{ result.position }}</td>
            <td style="padding: 12px; border: 1px solid #ddd;">{{ result.points }}</td>
            <td style="padding: 12px; border: 1px solid #ddd;">{{ result.assists }}</td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<div id="info-box" style="display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background-color: #f9f9f9; border: 1px solid #ddd; padding: 30px; border-radius: 8px; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1), 0 1px 3px rgba(0, 0, 0, 0.1); z-index: 1000; max-width: 90%; opacity: 0; transition: opacity 0.3s;"></div>

<div id="overlay" onclick="closeInfo()" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.5); z-index: 999; opacity: 0; transition: opacity 0.3s;"></div>

<script>
    function myFunction() {
        var checkBox = document.getElementById("checkbox");
        var inpt = document.getElementById("search_season");
    
        if (checkBox.checked == true){
            inpt.disabled = false;
        } else {
            inpt.disabled = true;
        }
        }

    function showInfo(name, season, team, position, points, assists, blocks, steals, games_played, minutes_played, three_points, two_points) {
        const infoBox = document.getElementById('info-box');
        const overlay = document.getElementById('overlay');
        infoBox.innerHTML = `
        <h3 style="margin-top: 0;">Player Details</h3>
        <hr>
        <div style="display: flex;">
        <div style="flex: 1;">
            <p><strong>Name:</strong> ${name}</p>
            <p><strong>Season:</strong> ${season}</p>
            <p><strong>Team:</strong> ${team}</p>
            <p><strong>Position:</strong> ${position}</p>
            <p><strong>Points:</strong> ${points}</p>
            <p><strong>Assists:</strong> ${assists}</p>
        </div>
        <div style="flex: 1;">
            <p><strong>Blocks:</strong> ${blocks}</p>
            <p><strong>Steals:</strong> ${steals}</p>
            <p><strong>Games Played:</strong> ${games_played}</p>
            <p><strong>Minutes Played:</strong> ${minutes_played}</p>
            <p><strong>Three Points:</strong> ${three_points}</p>
            <p><strong>Two Points:</strong> ${two_points}</p>
        </div>
        </div>
        <button style="width: 100%; height: 2rem; background-color: #4CAF50; border: none; color: white;" onClick="closeInfo()">Go Back</button>
        `;
        infoBox.style.opacity = '1';
        overlay.style.opacity = '1';
        infoBox.style.display = 'block';
        overlay.style.display = 'block';
    }

    function closeInfo() {
        const infoBox = document.getElementById('info-box');
        const overlay = document.getElementById('overlay');
        infoBox.style.opacity = '0';
        overlay.style.opacity = '0';
        setTimeout(() => {
            infoBox.style.display = 'none';
            overlay.style.display = 'none';
        }, 300);
    }
    </script>

{% endblock %}